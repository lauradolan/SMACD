# Get started with SMACD

Before you get started with SMACD, you will need to assemble 3 **maps**. You should base these maps off your existing project plans.

You will need:

1. A **project map** created by your project management team that lists your project's features and their use cases. The goal for future SMACD releases is to enable ingestion of this data from common project management software.
2. A **resource map** created by your product engineering team that lists endpoints in your system or application. The goal for future SMACD releases is to enable ingestion of this data from Swagger, etc.
3. A [**service map**](#service-map) created by your security team by combining the project map and resource map. This map lists the potential abuse cases for each use case. You can use an [**extension**](#extensions) to scan for and test these abuse cases, then generate an [**artifact correlation tree**](#artifact-correlation-tree).

## Service map

Your completed service map should look something like the following diagram:

```
Feature	// "User Can Locate Items"
└── Use Case	// "User Can Locate an Item by its Name"
    ├── Abuse Case	// "Attacker can SQL inject a Search Input"
    │   ├── Action Extension	// "sqlmap"
    │   └── Action Extension	// "sqlninja"
    └── Abuse Case	// "Attacker can use old Product UPCs"
        └── Action Extension	// "my_custom_extension"
```

For a sample service map, see **SMACD.Scanner/sample.yaml**.

## Extensions

There are two types of extensions, which are identified by their purposes: [**action** extensions](#action-extensions) and [**reaction** extensions](#reaction-extensions).

### Action extensions

Action extensions are explicitly queued by their **identifier**. You should use this identifier to test specific abuse cases in the service map.

### Reaction extensions

Reaction extensions are added to the **task queue** when they are activated by a [**trigger**](#triggers).

## Triggers

Triggers are critical to get the most out of the ability to see all this information in a single place. Triggers can originate from [**artifacts**](#artifact-triggers), [**extensions**](#extension-triggers) or [**system events**](#system-event-triggers).

### Artifact triggers

Triggers originate from an artifact when:

* A **child** is added to an artifact
* There is a change in the **informational fields** or **data artifacts**
* An **artifact** is created

### Extension triggers

Triggers originate from an extension when:

* A specific extension (determined by its identifier) is run and **succeeds**
* A specific extension (determined by its identifier) is run and **fails**

### System events triggers

Triggers originate from system events when:

* Any extension is **started**
* Any extension is **completed**
* Any extension is **faulted**
* The **task queue** is **drained**

## Artifact correlation tree

An artifact correlation tree is a structure generated by extensions during your security scan. You can use this tree to surface all discovered information, which enables your extensions to react dynamically based on what evidence has been consumed.

The strongly typed elements of this tree are structured as follows:

```
Artifact Root
└── Host Artifact (127.0.0.1)
    ├── Port Artifact
    │   ├── Open Port
    │   └── Protocol
    ├── Service Artifact (i.e. fingerprinting a service by type)
    │   ├── Service Name
    │   └── Service Banner
    └── Specific Service Artifact (i.e. HttpServicePortArtifact)
        ├── URL Segment ("/")
        │   └── URL Segment ("search")
        │       └── URL Segment ("index.aspx")
        │           ├── Fields in Page
        │           └── Extra Headers to Send
        ├── Server Version
        └── Modules Installed
```

Each artifact in the tree, regardless of location, can have a list of vulnerabilities and a key/value store for any object an extension wants to place at that node. This format allows all discovered information about the application surface to be correlated automatically in a single tree.
